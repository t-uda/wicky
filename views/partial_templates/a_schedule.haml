-# coding: utf-8
%section.schedule
  %h4{ id: "schedule-#{schedule.id}" } #{schedule.name}
  %dl
    %dt 場所
    %dd #{schedule.place}
    %dt 時間
    %dd
      = schedule.start
      &dash;
      = schedule.end
  != bind "schedule-#{schedule.id}-description", url('/api/kramdown') do
    :kramdown
      #{schedule.description}
  - binder_id = "schedule-#{schedule.id}"
  %form.modify-schedule{ action: url("/api/schedules/#{schedule.id}"), method: :post, 'data-binder' => binder_id }
    %p
      %input{ type: :hidden, name: :_method, value: :PUT }
      %input{ type: :hidden, name: :project_id, value: schedule.project.id }
      %input{ type: :hidden, name: :original, value: schedule.description }
      %input{ name: :name, value: schedule.name }
      %input{ name: :start, type: :datetime, value: schedule.start }
      %input{ name: :end, type: :datetime, value: schedule.end }
      %input{ name: :place, value: schedule.place }
      - if is_conflicted
        %div.alert-danger
          Conflicted!
      %textarea.form-control{ name: :description, 'data-binder' => "schedule-#{schedule.id}-description" }
        != preserve_newline (is_conflicted ? conflicted_description : schedule.description)
      %button.btn.btn-default{ type: :submit } 予定を編集する

